#! /etc/alternatives/octave -q

addpath("../../../src");

cr = crystal();
cr.a = [16.245976   16.792107   18.785768];
cr.b = [102.910000   90.060000   97.740000] * pi / 180;
cr.nat = 72;
cr.ntyp = 5;
cr.x = [
        0.500000    0.500000    0.500000
        0.000000    0.000000    0.000000
        0.837200    0.150100    0.797600
        0.162800    0.849900    0.202400
        0.127700    0.322300    0.939500
        0.872300    0.677700    0.060500
        0.342500    0.092600    0.897600
        0.657500    0.907400    0.102400
        0.196400    0.772900    0.813800
        0.803600    0.227100    0.186200
        0.978600    0.886300    0.660400
        0.021400    0.113700    0.339600
        0.879000    0.315700    0.832100
        0.121000    0.684300    0.167900
        0.053400    0.364700    0.829200
        0.946600    0.635300    0.170800
        0.296000    0.355400    0.945400
        0.704000    0.644600    0.054600
        0.373200    0.234800    0.852800
        0.626800    0.765200    0.147200
        0.416600    0.974800    0.811700
        0.583400    0.025200    0.188300
        0.359400    0.821100    0.844800
        0.640600    0.178900    0.155200
        0.159400    0.711300    0.670100
        0.840600    0.288700    0.329900
        0.991900    0.725800    0.644200
        0.008100    0.274200    0.355800
        0.824600    0.912100    0.630000
        0.175400    0.087900    0.370000
        0.823400    0.084000    0.653100
        0.176600    0.916000    0.346900
        0.840000    0.349000    0.934000
        0.160000    0.651000    0.066000
        0.822000    0.357000    0.764000
        0.178000    0.643000    0.236000
        0.092000    0.314000    0.737000
        0.908000    0.686000    0.263000
        0.072000    0.479000    0.843000
        0.928000    0.521000    0.157000
        0.338000    0.347000    0.045000
        0.662000    0.653000    0.955000
        0.325000    0.457000    0.908000
        0.675000    0.543000    0.092000
        0.326000    0.227000    0.754000
        0.674000    0.773000    0.246000
        0.493000    0.274000    0.862000
        0.507000    0.726000    0.138000
        0.535000    0.994000    0.833000
        0.465000    0.006000    0.167000
        0.392000    0.980000    0.714000
        0.608000    0.020000    0.286000
        0.420000    0.739000    0.797000
        0.580000    0.261000    0.203000
        0.375000    0.831000    0.951000
        0.625000    0.169000    0.049000
        0.182000    0.604000    0.646000
        0.818000    0.396000    0.354000
        0.230000    0.771000    0.615000
        0.770000    0.229000    0.385000
        0.963000    0.674000    0.548000
        0.037000    0.326000    0.452000
        0.919000    0.680000    0.709000
        0.081000    0.320000    0.291000
        0.750000    0.867000    0.686000
        0.250000    0.133000    0.314000
        0.796000    0.866000    0.539000
        0.204000    0.134000    0.461000
        0.910000    0.129000    0.607000
        0.090000    0.871000    0.393000
        0.718000    0.109000    0.618000
        0.282000    0.891000    0.382000
        ];
cr.typ = [1 2 3 3 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 4\
       4 4 4 4 4 4 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5\
       5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5];
cr.attyp = {"Ba","Cs","O","C","H"};
cr.ztyp = [56 55 8 6 1];

mol = cr_crystalbox(cr,[-0.5 -0.5 -0.5],[1.5 1.5 1.5]);
rep = mol_ball(mol);
rep = mol_stick(mol,rep,"O","C",[2.5 2.9] * 0.529,0);
rep = mol_stick(mol,rep,"C","C",[2.6 3.2] * 0.529,0);
rep = mol_stick(mol,rep,"C","H",[1.6 2.1] * 0.529,0);
rep = mol_stick(mol,rep,"Cs","O",[5.7 6.4] * 0.529,0);

rep_write_obj(rep,"tagfem.obj");

## from my version of g3dviewer
r = [
-0.0420026779 0.1364257634 -0.9897597432 
-0.1130207852 0.9836263061 0.1403766423 
0.9927046895 0.1177595407 -0.0258959532 
0.0000000000 0.0000000000 -50.0000000000
];
rep = rep_setdefaultscene(rep,r,0);
rep_write_pov(rep,"tagfem.pov");
system("povray -D -UV +Itagfem.pov +Otagfem.png +W1000 +H1000 +A");

